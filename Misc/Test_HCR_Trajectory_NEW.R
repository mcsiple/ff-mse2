# For testing HCR_Trajectory:
library(here)

basedir <- here()

  "/Users/mcsiple/Dropbox/Chapter4-HarvestControlRules/Code/ff-mse2"
source(file.path(basedir,"Recruitment/GenerateDevs.R"))
source(file.path(basedir,"Estimators/CalcFTrue.R"))
source(file.path(basedir,"Estimators/Estimators.R"))
source(file.path(basedir,"Run/generate_M.R"))
source(file.path(basedir,"Run/HCR_Trajectory_NEW.R")) # om

# Harvest rules
source(file.path(basedir,"Control Rules/smith_oceana.R"))
source(file.path(basedir,"Control Rules/cfp.R"))
source(file.path(basedir,"Control Rules/hockey-stick.R"))
source(file.path(basedir,"Control Rules/trend-based-rule.R"))
source(file.path(basedir,"Ctl/Anchovy_LHControl.R"))
source(file.path(basedir,"Ctl/Anchovy_FisheryControl.R"))
source(file.path(basedir,"Ctl/Menhaden_LHControl.R"))
source(file.path(basedir,"Ctl/Menhaden_FisheryControl.R"))
# 
# # 
# # # # # Anchovy recruitment dev params
recruit.sd <- 0.6
recruit.rho <- 0.5
steepness = 0.6
ages.test <- 0:6
nages.test <- length(ages.test)
time.var.m = NA
toplot <- FALSE
years.test <- 250
tim.params <- list(sigma0 = 0.2,tau0 = 0.1)
obs.cv <- 1.2
init <- init.test
F0 <- F0.test
cr <- NA
years <- years.test
hcr.type <- "constF"
equilib <- getEquilibriumConditions(lh = lh.test,fish = seq(0,5,by=.1),years = 150,steepness=steepness)
obs.type <- "AC"
tim.params <- tim.params
const.f.rate <- 0
sig.s <- 0.3
rec.ram <- NA
rec.dev = generate.devs(N = years.test,rho = recruit.rho,sd.devs = recruit.sd)
lh=lh.test
# These are all in the fishery control file
#tot <- sum(c(6.221,4.170,2.795,1.873,1.256,0.842,0.564))
#init.prop <- c(6.221,4.170,2.795,1.873,1.256,0.842,0.564)/tot
#init.B <- init.prop*200000 # Biomass at age -- 110.54 is the B0 when R0 = 1000
#init.test <- init.B / lh.test$w.at.age # These are all the numbers at age (spawning and non-spawning biomass)
#init = init.test
R0.traj = NA
F0.test <- 0.3 # This is arbitrary
tim.rand.inits = c(-0.11, -0.05, 0.31, 0.01, 0.03, 0.34, 0.09) # For menhaden
tim.rands = structure(c(-0.11, -0.06, -0.04, 0.11, 0.03, 0.04, 0.01, -0.05,
                        0.16, 0.04, -0.18, 0.06, -0.04, -0.1, -0.02, -0.09, -0.07, -0.06,
                        -0.15, 0.07, 0.01, -0.1, 0.11, 0.04, -0.03, 0.08, 0.08, 0.07,
                        0.06, 0.05, -0.01, -0.03, -0.03, -0.06, -0.02, -0.11, 0.19, 0.11,
                        -0.1, -0.04, -0.04, 0.07, -0.01, 0.02, 0, 0, 0.12, -0.02, 0.14,
                        -0.14, 0.05, 0.01, 0.02, 0.03, -0.04, -0.03, -0.09, -0.1, 0.03,
                        0.04, 0, 0.08, 0.18, -0.04, -0.21, 0.09, -0.06, -0.06, 0.09,
                        -0.03, -0.11, 0.02, -0.01, 0, 0.03, -0.03, 0.06, -0.02, 0.03,
                        0.1, 0.04, -0.03, 0.1, 0.09, 0.05, 0.02, -0.06, 0.12, -0.05,
                        0.2, 0.14, -0.02, -0.09, -0.06, 0.02, -0.02, -0.03, -0.09, 0,
                        -0.07, -0.15, -0.03, 0.08, -0.05, 0.05, -0.14, 0, 0.05, 0.03,
                        0.01, -0.06, -0.08, -0.09, 0.01, -0.08, -0.04, -0.02, 0.16, -0.06,
                        0.02, 0.01, -0.09, -0.01, 0.13, 0.04, 0, -0.04, -0.18, 0.1, -0.13,
                        0.07, 0.17, -0.13, 0.06, -0.02, -0.14, -0.14, -0.14, -0.05, -0.13,
                        0.06, 0.19, -0.12, 0.07, 0.07, 0.03, -0.09, -0.01, -0.03, 0.05,
                        -0.03, 0.09, -0.03, 0.09, -0.09, -0.11, 0.29, -0.04, 0.03, 0.06,
                        -0.04, 0.05, 0.03, -0.02, 0.01, 0, 0.19, -0.07, -0.1, 0, 0.03,
                        0.04, -0.04, -0.1, 0.11, -0.03, -0.08, -0.02, -0.02, 0.1, 0.01,
                        0.07, -0.04, 0.02, -0.03, 0.01, -0.08, -0.12, 0.18, 0.05, -0.11,
                        -0.05, -0.11, 0.2, 0.12, -0.02, 0.05, -0.04, -0.04, -0.07, -0.05,
                        0.15, 0, 0.01, 0.02, 0.11, -0.05, -0.09, 0.15, -0.04, -0.06,
                        -0.11, -0.11, -0.05, 0.06, 0.1, 0.06, -0.03, 0.01, -0.06, -0.06,
                        0.08, -0.09, 0.17, -0.01, 0.02, -0.07, -0.05, -0.12, -0.02, 0.04,
                        0.03, -0.07, -0.07, -0.04, 0.13, -0.1, -0.02, 0.17, -0.01, -0.12,
                        -0.06, 0.04, -0.03, -0.05, -0.03, 0.01, 0.14, -0.01, 0.1, 0.06,
                        -0.01, -0.14, -0.05, -0.04, 0, 0.12, 0.21, 0.14, -0.01, -0.16,
                        -0.03, 0.01, 0.08, 0.09, 0.06, -0.12, 0.08, -0.04, 0.02, 0.01,
                        0.04, 0, -0.15, 0.07, 0.03, -0.02, 0.01, 0.01, 0.02, 0.15, -0.02,
                        0.02, 0.1, 0.09, 0.1, -0.05, 0.18, 0.01, 0.17, -0.12, 0, 0.11,
                        -0.06, -0.07, -0.08, -0.09, -0.04, 0.03, -0.18, 0.02, 0.11, 0.18,
                        0.12, 0.07, -0.15, -0.05, -0.03, 0.06, -0.01, -0.11, 0.15, 0.08,
                        0.02, 0.11, -0.12, 0.06, -0.05, 0.06, -0.01, 0.06, 0.12, 0, 0.09,
                        -0.11, -0.06, 0.14, 0.03, -0.18, -0.12, -0.02, 0.08, -0.01, 0.06,
                        0.09, 0.15, 0.01, 0, -0.16, 0.01, -0.05, -0.09, -0.02, 0.09,
                        -0.18, -0.04, 0.01, -0.08, 0.03, 0.04, 0, -0.22, 0.23, -0.02,
                        0.06, 0.02, 0.09, 0.07, -0.02, 0.03, -0.08, 0.08, -0.04, 0.22,
                        -0.15, -0.04, 0.07, 0.05, -0.05, -0.09, 0.01, 0, -0.16, 0, 0.02,
                        0.02, -0.09, 0.04, 0.12, 0.04, -0.1, -0.04, 0.03, -0.06, -0.19,
                        0.08, -0.07, -0.05, 0.13, -0.07, 0.08, -0.11, -0.03, -0.01, -0.1,
                        -0.06, 0, 0.06, -0.15, -0.03, 0.07, -0.05, 0.02, 0.04, 0.02,
                        0.06, -0.01, -0.04, -0.24, -0.01, 0.04, 0.05, -0.05, 0.16, 0.03,
                        0.01, 0.11, -0.06, -0.04, 0.21, 0, 0.15, -0.13, -0.02, 0.03,
                        0.03, -0.09, 0, -0.1, 0.06, 0.1, -0.2, 0.11, -0.11, 0.04, 0.06,
                        -0.02, -0.06, 0.01, 0.04, 0.08, -0.18, -0.15, 0.13, 0.09, 0.04,
                        0.06, 0.08, -0.24, 0.1, -0.04, 0.02, -0.03, 0.08, -0.03, 0.05,
                        -0.03, -0.1, 0.11, 0.07, 0.15, 0.01, 0.1, 0.18, -0.03, -0.12,
                        -0.02, -0.02, 0.01, 0.15, -0.03, 0.03, -0.02, 0, 0.03, 0.12,
                        0.01, 0.06, 0.07, 0.08, -0.05, 0.15, -0.03, -0.01, 0.13, 0.12,
                        -0.1, -0.08, -0.12, 0.02, 0.01, 0.03, 0.05, -0.05, -0.09, 0.09,
                        0.07, -0.13, -0.01, -0.08, -0.19, 0.01, -0.01, -0.01, 0.02, 0.08,
                        0.02, -0.06, -0.07, -0.01, 0.03, -0.09, -0.02, 0.09, -0.01, -0.06,
                        -0.02, 0.1, 0.05, 0.11, 0.01, 0.04, -0.05, 0.05, -0.05, -0.13,
                        0.01, 0.17, 0.07, 0.1, 0.03, -0.05, -0.02, -0.02, -0.04, 0.06,
                        -0.11, 0.08, 0.08, -0.11, 0.06, 0.22, -0.05, 0.08, -0.07, 0.1,
                        0.02, 0.15, -0.13, 0, -0.05, -0.02, -0.06, -0.07, 0.05, -0.1,
                        0.13, -0.11, 0.01, 0.05, 0.05, -0.03, 0.01, 0.09, -0.13, -0.07,
                        0.03, -0.04, 0.12, 0.06, 0.01, -0.13, 0, -0.03, -0.01, -0.11,
                        0.04, -0.09, -0.02, 0.03, -0.07, 0.05, -0.12, -0.25, 0.04, 0.08,
                        -0.03, 0.05, -0.1, -0.01, -0.17, 0.11, 0.17, 0.1, 0, 0, -0.14,
                        0.07, -0.02, -0.06, -0.13, -0.03, -0.08, -0.04, -0.11, 0.15,
                        0, 0.1, -0.23, -0.04, -0.06, -0.11, 0.14, -0.13, 0.03, 0.08,
                        0.02, -0.08, 0.08, 0.02, -0.1, -0.12, 0.19, -0.06, -0.17, 0.05,
                        0.03, -0.12, -0.17, -0.01, 0.1, 0.06, -0.04, -0.07, 0.02, 0.01,
                        0.06, -0.04, 0.08, -0.07, -0.03, 0.07, 0.09, -0.17, 0.01, 0.05,
                        -0.13, 0.04, -0.07, 0.09, 0.05, 0.07, 0.01, 0.08, 0.12, 0.18,
                        0, -0.2, 0, 0.02, -0.01, 0.05, 0.09, -0.05, -0.03, 0.04, -0.05,
                        0.01, -0.18, -0.1, -0.12, -0.08, -0.06, 0.03, 0.09, -0.07, -0.09,
                        -0.09, -0.04, -0.02, 0.04, -0.03, -0.19, -0.01, 0.11, 0.11, -0.07,
                        -0.14, 0.22, -0.01, -0.01, 0.04, -0.14, -0.07, -0.14, -0.06,
                        0.01, -0.12, 0.05, 0.03, -0.08, 0.02, 0.07, 0.09, -0.02, -0.01,
                        -0.01, 0.13, 0.1, 0.07, -0.03, 0.03, 0.04, -0.09, -0.15, 0.06,
                        -0.14, 0, 0.02, 0.05, 0.02, -0.07, 0.09, 0.16, 0.08, -0.17, 0.13,
                        -0.01, 0.05, 0.06, -0.01, -0.01, 0.09, 0.06, 0.09, 0.21, 0.06,
                        0.02, -0.2, 0.24, -0.04, 0.21, 0.03, 0.14, -0.01, 0.05, 0.02,
                        -0.02, -0.01, 0.09, -0.02, -0.18, -0.02, 0.05, 0.06, 0.06, -0.15,
                        0.03, 0.09, 0.11, -0.02, -0.03, 0.13, -0.15, -0.04, 0.04, -0.14,
                        0.03, 0.17, 0, -0.02, 0.04, -0.02, 0.07, 0.08, 0, -0.11, -0.12,
                        -0.05, 0.07, -0.18, -0.17, -0.06, 0.04, -0.08, 0.08, 0.03, -0.02,
                        0.07, 0.03, -0.04, 0.02, 0.06, 0.03, -0.06, 0.08, 0.1, 0.02,
                        0.01, -0.01, 0.19, 0.02, -0.01, -0.22, -0.14, -0.01, 0.02, 0.02,
                        0.07, -0.02, 0.11, -0.08, -0.11, -0.11, 0.07, -0.01, 0.07, -0.02,
                        -0.05, -0.03, -0.17, -0.1, -0.13, 0.09, -0.05, 0.07, 0.14, -0.02,
                        0.03, -0.16, -0.07, 0.01, 0.03, -0.07, 0.24, -0.04, 0.01, 0.06,
                        0, -0.06, 0.09, 0.14, 0, 0.05, -0.01, 0.09, -0.1, 0.21, -0.05,
                        -0.13, -0.03, 0.01, 0.15, 0.08, 0.01, -0.12, -0.08, -0.01, 0.23,
                        -0.17, 0.1, -0.05, 0.15, -0.1, 0.01, -0.1, 0.08, 0.13, 0.17,
                        0.07, 0.16, 0.11, -0.01, 0.04, -0.09, -0.02, 0.11, 0.05, 0.04,
                        -0.09, -0.05, -0.07, 0.04, -0.09, 0.05, -0.1, 0.16, 0.04, -0.06,
                        0.02, -0.03, 0.03, 0.02, -0.09, -0.07, 0.03, 0.15, 0.1, -0.06,
                        0.07, 0, 0.03, 0.02, 0.23, -0.11, 0.01, -0.16, 0.05, 0.1, 0.13,
                        -0.17, 0.04, 0.14, -0.04, -0.02, 0, 0.03, 0.06, 0.12, -0.01,
                        0.02, 0.22, 0.04, 0.02, -0.12, 0, -0.02, 0, -0.05, -0.06, -0.06,
                        -0.02, 0.12, 0.09, -0.03, -0.15, -0.08, -0.04, 0.01, -0.06, 0.18,
                        -0.02, -0.11, -0.01, -0.09, 0.01, 0.02, 0.03, -0.15, 0.02, 0.03,
                        -0.13, 0.09, 0.07, 0.21, 0.01, 0, 0.01, 0.01, -0.17, -0.15, -0.01,
                        -0.05, 0, -0.19, -0.13, -0.1, 0.09, -0.1, -0.07, 0.01, -0.03,
                        0.01, 0.21, -0.1, -0.03, -0.05, 0.14, -0.07, -0.01, 0.07, -0.09,
                        0.15, 0.06, -0.1, 0.04, -0.02, 0.03, -0.01, 0.1, -0.12, -0.05,
                        -0.02, -0.09, -0.09, 0, -0.01, -0.23, 0.09, 0.02, 0.22, 0.06,
                        -0.04, 0.25, 0.25, -0.11, 0.04, -0.02, 0.02, 0.02, -0.11, 0.03,
                        0.16, -0.01, -0.01, 0.13, 0.08, -0.15, 0.02, 0.15, 0.13, 0.04,
                        0.06, -0.11, 0.03, -0.09, -0.04, 0.08, -0.1, 0.02, 0.04, 0, 0.16,
                        -0.09, 0.05, -0.01, -0.02, 0.04, -0.09, -0.12, -0.04, 0.16, 0,
                        0.03, -0.02, 0.04, -0.09, 0.1, 0.05, -0.07, 0, 0.06, 0.05, 0.13,
                        -0.05, 0.1, 0.09, -0.01, -0.09, -0.1, 0.04, -0.01, 0.16, 0.05,
                        -0.03, -0.09, -0.05, 0.03, -0.04, 0.05, -0.03, -0.01, -0.07,
                        0.17, 0.03, 0.02, -0.15, 0.06, -0.09, -0.08, 0.08, -0.04, -0.16,
                        0.16, -0.21, 0.05, 0.09, -0.06, 0.04, 0.04, 0.09, 0.04, -0.02,
                        0.08, 0.07, -0.08, -0.13, 0.01, -0.02, -0.09, 0.01, -0.12, 0.01,
                        -0.06, 0.09, 0.22, -0.08, 0.09, 0.07, -0.01, -0.04, 0.14, -0.18,
                        -0.06, -0.13, 0.12, -0.02, -0.05, 0.28, 0, -0.04, 0.03, -0.14,
                        0.04, -0.01, 0.04, -0.09, -0.09, -0.06, -0.07, 0.12, 0.14, -0.01,
                        -0.03, -0.03, 0.01, 0.01, 0.03, -0.07, -0.08, 0.11, -0.05, 0.03,
                        -0.01, -0.09, 0.05, 0.02, 0.13, 0.01, -0.03, 0.02, -0.11, -0.07,
                        0.05, -0.03, -0.01, -0.01, -0.06, -0.18, 0.03, 0.07, -0.12, 0.13,
                        0.03, 0.12, -0.09, 0.01, -0.01, 0.07, -0.05, 0, -0.16, -0.07,
                        0.01, -0.06, 0, -0.04, 0.05, 0.1, -0.07, -0.03, 0.13, -0.2, -0.03,
                        0.18, 0.2, 0.01, -0.08, 0.01, -0.06, 0.13, -0.07, 0.03, 0.06,
                        -0.07, 0.08, -0.07, 0.06, 0.1, -0.09, 0.1, -0.04, 0.03, 0.02,
                        -0.04, 0.02, -0.11, -0.01, 0.07, -0.19, -0.13, -0.1, -0.14, 0.04,
                        -0.09, -0.19, -0.06, -0.03, 0.08, -0.1, 0.1, 0.04, 0.03, -0.08,
                        0.17, -0.01, -0.16, -0.02, -0.17, -0.03, -0.04, 0.06, 0.09, -0.06,
                        0.07, 0.13, -0.07, -0.06, 0.06, 0.02, 0.05, 0.13, 0.03, 0.09,
                        0.06, 0.04, 0.03, 0.12, -0.09, -0.1, 0.05, -0.01, 0.01, 0.07,
                        0.07, -0.02, -0.03, 0.01, 0.1, 0.04, 0.13, 0, 0.1, 0.08, 0.05,
                        0.04, -0.03, -0.01, 0.02, 0, 0.08, -0.01, -0.01, -0.04, -0.01,
                        -0.01, -0.21, -0.12, -0.01, -0.02, -0.11, -0.18, -0.03, 0.06,
                        0.16, 0, 0.13, 0.01, 0.01, 0.03, -0.08, 0, 0.08, -0.07, -0.03,
                        -0.1, 0.03, 0.04, 0.06, -0.11, 0.01, -0.08, 0, 0.12, -0.05, 0.06,
                        -0.07, -0.04, 0.04, -0.06, -0.15, 0.11, 0.03, -0.05, -0.18, 0.17,
                        0.3, 0.02, 0.08, 0.11, -0.06, -0.03, -0.15, -0.07, 0.06, -0.03,
                        -0.02, -0.01, -0.17, 0.07, -0.13, -0.02, -0.04, -0.02, 0.13,
                        -0.05, -0.07, -0.14, -0.07, -0.1, 0.04, -0.08, 0.03, -0.01, -0.13,
                        -0.07, 0.08, 0.08, 0.18, 0, -0.13, -0.07, 0.04, 0.17, 0.01, 0.1,
                        0.07, -0.1, -0.02, 0.12, 0.08, 0.04, 0.04, -0.04, -0.12, 0.12,
                        -0.13, -0.08, 0.06, -0.11, -0.05, -0.11, 0.06, 0.04, 0.04, 0.04,
                        0.05, 0.06, -0.18, -0.01, 0.01, 0.06, -0.11, -0.04, -0.1, 0.09,
                        0.11, 0.07, -0.11, 0.04, 0.1, 0.02, -0.05, -0.1, -0.06, 0.06,
                        -0.04, 0.02, 0.12, 0.05, 0.12, -0.15, -0.03, 0.01, 0.05, -0.1,
                        0.07, 0.03, 0.02, 0.05, -0.01, 0.08, 0.06, -0.01, 0.09, 0.03,
                        0.06, -0.05, 0.14, 0, 0.08, -0.01, -0.03, 0.07, -0.14, 0.04,
                        0.04, -0.24, 0.03, -0.19, 0.06, -0.04, -0.06, 0, 0.12, -0.06,
                        0.05, 0.03, -0.11, -0.16, -0.18, 0.05, 0, 0.17, 0.05, 0.08, 0.12,
                        -0.04, 0.05, 0.08, 0.12, 0.07, 0.04, -0.08, 0.07, 0.04, 0.06,
                        0.04, -0.02, -0.01, 0.06, 0.02, -0.07, -0.03, -0.12, -0.09, -0.01,
                        -0.16, -0.15, 0.1, -0.05, -0.17, -0.01, 0.12, 0.06, 0.04, 0.11,
                        -0.07, 0.07, -0.05, 0, 0.2, 0.09, 0.07, -0.1, -0.07, 0.2, -0.1,
                        0.02, 0.08, 0.09, 0.1, -0.01, -0.07, -0.03, -0.08, 0.06, 0.1,
                        0.19, 0.03, -0.08, 0.09, 0.08, -0.02, -0.14, 0.07, 0.1, -0.03,
                        0.05, -0.02, 0.06, -0.01, -0.03, 0.01, -0.03, -0.05, -0.03, 0,
                        0.02, 0.14, -0.12, -0.02, 0.06, 0.16, 0.04, 0, -0.03, 0.04, 0.09,
                        -0.02, 0.01, 0.02, 0.07, 0.1, 0.02, -0.01, 0.12, 0.01, 0.14,
                        -0.01, 0.05, -0.14, -0.01, 0, -0.07, -0.09, 0.08, 0.08, -0.12,
                        0.04, -0.1, -0.09, 0.05, -0.06, 0.09, 0, 0.05, -0.05, -0.1, 0.08,
                        0.02, -0.02, 0.01, 0.12, -0.06, -0.07, -0.06, -0.14, 0.07, 0.02,
                        0.02, 0, -0.05, -0.07, 0.08, -0.13, 0.04, -0.07, 0.03, -0.07,
                        -0.05, 0.16, 0.06, -0.19, 0.01, -0.04, -0.1, 0.02, 0.01, -0.03,
                        0.18, -0.2, 0.07, -0.03, 0.06, -0.04, -0.05, -0.15, -0.02, 0.22,
                        0.09, 0.15, 0.08, 0.1, 0.08, 0.04, -0.05, -0.05, -0.14, 0, 0.08,
                        0.09, 0.01, -0.05, 0.29, 0.07, 0.13, -0.03, 0, 0.04, 0.15, -0.03,
                        0.08, -0.19, -0.05, -0.12, 0.1, -0.01, -0.03, 0.12, 0.1, -0.08,
                        0.04, -0.11, -0.04, 0.14, 0.13, 0.1, -0.05, -0.17, -0.11, 0.09,
                        -0.03, -0.19, -0.02, 0.13, 0.06, -0.07, -0.14, -0.07, 0, 0.08,
                        -0.17, 0.09, 0, 0.05, -0.15, -0.06, -0.04, 0.09, 0.09, 0.04,
                        0.14, -0.05, 0.09, 0, -0.06, 0.08, 0.12, 0.08, -0.05, -0.04,
                        0.12, 0.03, 0.07, -0.03, 0.11, -0.07, 0.06, -0.07, -0.22, -0.12,
                        0.01, 0.08, -0.16, -0.11, 0.16, -0.04, 0.05, -0.05, -0.03, 0.01,
                        0, -0.02, -0.04, -0.27, 0.17, 0.16, -0.1, -0.02, 0.12, 0.09,
                        0.11, -0.1, 0.23, -0.1, 0.07, 0.01, -0.04, -0.03, -0.09, 0.15,
                        0.01, 0.02, 0.02, -0.03, -0.1, 0.02, -0.19, -0.13, -0.1, -0.1,
                        0.01, 0.14, -0.14, 0.04, 0.08, -0.09, 0, 0.07, -0.02, -0.02,
                        0.03, -0.01, -0.05, -0.01, 0.17, 0.08, -0.08, -0.11, -0.03, 0.12,
                        0.03, -0.06, 0.08, -0.01, -0.1, 0.04, 0.14, 0.04), .Dim = c(7L,
                                                                                    250L))
curly.phi.vec = c(-0.17, -0.07, 0.47, 0.02, 0.04, 0.51, 0.14, -0.38, -0.21, -0.13,
                  0.37, 0.11, 0.12, 0.03, -0.17, 0.54, 0.15, -0.59, 0.21, -0.14,
                  -0.32, -0.07, -0.31, -0.22, -0.19, -0.51, 0.25, 0.05, -0.34,
                  0.38, 0.13, -0.09, 0.27, 0.26, 0.25, 0.21, 0.17, -0.02, -0.09,
                  -0.11, -0.21, -0.06, -0.38, 0.65, 0.36, -0.34, -0.12, -0.14,
                  0.23, -0.03, 0.08, -0.01, -0.01, 0.41, -0.07, 0.45, -0.46, 0.18,
                  0.04, 0.06, 0.11, -0.15, -0.1, -0.31, -0.32, 0.09, 0.13, 0.02,
                  0.28, 0.62, -0.15, -0.69, 0.3, -0.21, -0.21, 0.31, -0.09, -0.37,
                  0.05, -0.04, 0, 0.12, -0.11, 0.19, -0.07, 0.1, 0.33, 0.13, -0.1,
                  0.34, 0.3, 0.16, 0.07, -0.19, 0.41, -0.18, 0.66, 0.46, -0.07,
                  -0.31, -0.21, 0.08, -0.07, -0.1, -0.29, -0.01, -0.24, -0.5, -0.11,
                  0.28, -0.17, 0.18, -0.49, -0.02, 0.16, 0.09, 0.03, -0.19, -0.25,
                  -0.31, 0.04, -0.28, -0.15, -0.08, 0.55, -0.2, 0.07, 0.02, -0.29,
                  -0.02, 0.43, 0.14, 0.01, -0.13, -0.62, 0.34, -0.44, 0.22, 0.57,
                  -0.43, 0.21, -0.08, -0.47, -0.45, -0.48, -0.16, -0.44, 0.21,
                  0.63, -0.39, 0.24, 0.23, 0.1, -0.3, -0.04, -0.08, 0.17, -0.11,
                  0.29, -0.11, 0.32, -0.31, -0.38, 0.97, -0.13, 0.09, 0.19, -0.15,
                  0.16, 0.11, -0.06, 0.02, -0.01, 0.64, -0.22, -0.33, 0.01, 0.09,
                  0.13, -0.14, -0.32, 0.38, -0.1, -0.26, -0.07, -0.06, 0.33, 0.03,
                  0.23, -0.15, 0.06, -0.1, 0.03, -0.27, -0.39, 0.6, 0.18, -0.38,
                  -0.18, -0.36, 0.66, 0.39, -0.08, 0.16, -0.12, -0.14, -0.24, -0.18,
                  0.5, -0.02, 0.04, 0.07, 0.37, -0.15, -0.3, 0.5, -0.13, -0.22,
                  -0.37, -0.39, -0.17, 0.19, 0.33, 0.21, -0.11, 0.02, -0.21, -0.22,
                  0.27, -0.3, 0.59, -0.03, 0.06, -0.22, -0.17, -0.4, -0.05, 0.13,
                  0.1, -0.23, -0.24, -0.15, 0.45, -0.34, -0.05, 0.57, -0.03, -0.41,
                  -0.2, 0.15)


#set.seed(123)
tiff("B0_anchovy.tiff",width = 8,height = 7,units = 'in',res = 150)
par(mfrow=c(3,3))
for(i in 1:9){
  rec.dev.test <- generate.devs(N = years.test,rho = recruit.rho,sd.devs = recruit.sd)
  rec.dev = rec.dev.test
  testie4 <- calc.trajectory(lh = lh.test,obs.cv = 1.2, init = init.test, rec.dev = rec.dev.test, F0 = F0, cr = cr, years = years.test,hcr.type = hcr.type,equilib = equilib,steepness=steepness,obs.type = obs.type, tim.params = tim.params,const.f.rate=const.f.rate, sig.s = .3,rec.ram=NA,time.var.m = NA,tim.rand.inits = tim.rand.inits,tim.rands = tim.rands,curly.phi.vec = curly.phi.vec)

  plot(testie4$biomass.oneplus.true,type='l',ylim=c(0,9e5),ylab="B1+ true")
  #lines(testie4$total.catch,col='red')
}
dev.off()
# any(testie4$total.catch == 0)
# plot(testie4$intended.f,type='l')
# lines(testie4$fishing,col='red')
# which(testie4$biomass.oneplus.true < testie4$total.catch)